const data = {
  sources: [
    { id: 1, name: 'meduza' },
    { id: 6, name: '3dnews' },
    { id: 7, name: 'nytimes' },
    { id: 8, name: 'forbes' },
    { id: 9, name: 'igromania' },
    { id: 10, name: 'buro237' },
    { id: 11, name: 'rusvesna' },
    { id: 12, name: '7ya' },
    { id: 14, name: 'aif' },
    { id: 15, name: 'gazetaru' },
    { id: 16, name: 'karpov.courses' },
  ],
  categories: [
    { id: 1, name: 'tech' },
    { id: 2, name: 'sport' },
    { id: 3, name: 'fashion' },
    { id: 4, name: 'politics' },
    { id: 5, name: 'other' },
    { id: 6, name: 'karpov.courses' },
  ],
  items: [
    {
      id: 338945,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:54:58 GMT+0300 (Moscow Standard Time)',
      title:
        'Прокуратура поищет дискредитацию ВС РФ в высказываниях актера Козловского',
      description:
        'С просьбой провести проверку выступил глава ФПБК Виталий Бородин.',
      image: '',
      source_id: 14,
      category_id: 5,
    },
    {
      id: 338950,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:42:05 GMT+0300 (Moscow Standard Time)',
      title:
        'Байден настаивает, чтобы трансгендеров допускали до спортивных соревнований',
      description:
        'В ближайшее время конгресс США может принять закон о запрете на участие школьников-трансгендеров в спортивных состязаниях.',
      image:
        'https://aif-s3.aif.ru/images/032/017/0a1a8f4ee6cc6c70d49da67432fe9a4b.jpg',
      source_id: 14,
      category_id: 2,
    },
    {
      id: 338956,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:41:25 GMT+0300 (Moscow Standard Time)',
      title:
        'Сенатор Башкин: Вассерман пошутил о декларировании наличных денег',
      description:
        'Ранее Вассерман предложил добровольно декларировать наличные на сумму от 1 млн рублей.',
      image:
        'https://aif-s3.aif.ru/images/032/017/f4b958068717d042b1dd5a185ddf85e8.jpg',
      source_id: 14,
      category_id: 5,
    },
    {
      id: 339003,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:38:39 GMT+0300 (Moscow Standard Time)',
      title:
        'Nature: нелюбовь матери вызывает у детей постоянное ожидание одобрения по мере взросления',
      description:
        'Группа ученых из Германии выяснила, что люди, которые испытывали нелюбовь или безразличие матери, гораздо чаще оказывались среди тех, кто постоянно ожидал одобрения и других социальных поощрений. Научная работа опубликована в журнале ...',
      image:
        'https://img.gazeta.ru/files3/545/16571545/20200402_gaf_u55_594-pic905-895x505-69027.jpg',
      source_id: 15,
      category_id: 1,
    },
    {
      id: 338941,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:29:27 GMT+0300 (Moscow Standard Time)',
      title: 'Хоррор-выживалка Suffer the Night вышла в Steam',
      description: 'И продаётся со скидкой.',
      image:
        'https://cdn.igromania.ru/mnt/news/5/2/2/e/2/8/125449/3efdd751d1ef4621_848x477.jpg',
      source_id: 9,
      category_id: 1,
    },
    {
      id: 338963,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:27:23 GMT+0300 (Moscow Standard Time)',
      title:
        'Лавров: РФ заинтересована в скорейшем разрешении конфликта на Украине',
      description:
        'Глава МИД России выразил Бразилии признательность за понимание ситуации.',
      image:
        'https://aif-s3.aif.ru/images/032/017/71797813a15595ea349dde702b99f791.jpg',
      source_id: 14,
      category_id: 4,
    },
    {
      id: 338965,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:26:18 GMT+0300 (Moscow Standard Time)',
      title: 'ВСУ во второй раз за день обстреляли село в Белгородской области',
      description:
        'Снаряды попали по зернохранилищу и повредили линию электропередачи.',
      image:
        'https://aif-s3.aif.ru/images/032/017/90fe2c6c79154bf10c42166669835f43.jpg',
      source_id: 14,
      category_id: 5,
    },
    {
      id: 338996,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:22:00 GMT+0300 (Moscow Standard Time)',
      title:
        '«Ждал 10 лет, чуть не состарился»: релизный трейлер Dead Island 2 воодушевил игроков перед долгожданной премьерой',
      description:
        'В преддверии уже совсем скорого выхода своего амбициозного зомби-боевика Dead Island 2 издательство Deep Silver и разработчики из принадлежащей ему британской Dambuster Studios представили релизный трейлер игры.',
      image:
        'https://3dnews.ru/assets/external/illustrations/2023/04/17/1085186/00.jpg',
      source_id: 6,
      category_id: 1,
    },
    {
      id: 338944,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:20:57 GMT+0300 (Moscow Standard Time)',
      title: 'Бренд Viva La Vika представил вечные браслеты',
      description:
        'Бренд Viva La Vika представил новинку — вечные браслеты. Украшение запаивается прямо на руке специальным аппаратом из Америки. Это западный тренд, впервые представленный на российском рынке. Вставку для браслета можно выбрать — доступны бриллиант, изумруд, рубин, синий или...',
      image: 'https://www.buro247.ru/images/vivalavika1704.png',
      source_id: 10,
      category_id: 5,
    },
    {
      id: 338974,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:19:59 GMT+0300 (Moscow Standard Time)',
      title:
        'Yum! Brands покинула российский рынок, продав бизнес KFC компании "Смарт сервис ЛТД"',
      description:
        'Американская компания Yum! Brands покинула российский рынок, завершив сделку по продаже бизнеса KFC в России компании "Смарт сервис". Об этом сообщается на сайте компании.\n\n"Yum! Brands завершила уход с российского рынка, ...',
      image:
        'https://img.gazeta.ru/files3/665/14627665/upload-Depositphotos_354314768_XL-pic905-895x505-40265.jpg',
      source_id: 15,
      category_id: 4,
    },
    {
      id: 338939,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:18:16 GMT+0300 (Moscow Standard Time)',
      title: 'Крупнейший банк Кипра закрывает счета россиян: чего ждать дальше',
      description:
        'Bank Of Cyprus — крупнейший банк на Кипре — разослал уведомления российским клиентам о том, что их счета будут закрыты. Решение было принято после очередного расширения американского SDN-листа. Банк опасается санкций за обслуживание россиян',
      image: '',
      source_id: 8,
      category_id: 5,
    },
    {
      id: 338967,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:18:14 GMT+0300 (Moscow Standard Time)',
      title: 'Бездомные собаки напали на малолетнего мальчика в Чите',
      description: 'Ребенка госпитализировали.',
      image:
        'https://aif-s3.aif.ru/images/032/017/bf708da06ff660ace1fa0ed74b4e8d09.jpg',
      source_id: 14,
      category_id: 5,
    },
    {
      id: 338946,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:17:38 GMT+0300 (Moscow Standard Time)',
      title:
        'В Минцифры сообщили об отсутствии оснований для рассылки повесток через «Госуслуги»',
      description:
        'Оснований для рассылки повесток через портал госуслуг сейчас нет, заявили в Минцифры. Правительство еще не определило способы направления повесток, пояснили там. Ранее военком Москвы заявил, что электронные повестки начнут рассылать призывникам в тестовом режиме уже во время этого весеннего призыва',
      image: '',
      source_id: 8,
      category_id: 5,
    },
    {
      id: 338949,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:14:58 GMT+0300 (Moscow Standard Time)',
      title:
        'Mario Kart&amp;nbsp;8 Deluxe не смогла обогнать FIFA&amp;nbsp;23 в британской рознице',
      description: 'Ремейк Resident Evil 4 на третьем месте.',
      image:
        'https://cdn.igromania.ru/mnt/news/f/5/d/3/6/a/125448/d2b8f926e72c5b97_848x477.jpg',
      source_id: 9,
      category_id: 1,
    },
    {
      id: 338948,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:13:21 GMT+0300 (Moscow Standard Time)',
      title:
        'Пограничная полиция Молдавии объяснила отказ во въезде главе Татарстана',
      description:
        'Пограничная полиция Молдавии заявила, что заявления российского чиновника о том, что он объявлен персоной нон грата в стране, не соответствуют действительности. В ведомстве не назвали имени. Однако ранее об отказе ему во въезде в Молдавию заявил глава Татарстана Рустам Минниханов. По его словам, отказ во въезде был обусловлен тем, что его сочли «нежелательным гражданином»',
      image: '',
      source_id: 8,
      category_id: 5,
    },
    {
      id: 338968,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:12:58 GMT+0300 (Moscow Standard Time)',
      title: 'Новое скетч-шоу Михаила Галустяна выйдет в конце апреля',
      description: 'Шоу будет называться «Галустян+».',
      image:
        'https://aif-s3.aif.ru/images/032/017/66301e3f6d6f33debb8a3160be086375.jpg',
      source_id: 14,
      category_id: 3,
    },
    {
      id: 339004,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:10:09 GMT+0300 (Moscow Standard Time)',
      title:
        'Российские ученые создали наночастицы для ускорения роста растений',
      description:
        'Созданные в России наночастицы способны ускорять рост растений при внесении их в качестве "подкормки". Об этом сообщает пресс-служба НИТУ МИСИС.\n\nВ последние годы ученые экспериментируют с различными металлическими наночастицами, ...',
      image:
        'https://img.gazeta.ru/files3/419/16571419/photo_2023-04-17_18.49-pic905-895x505-9757.jpg',
      source_id: 15,
      category_id: 1,
    },
    {
      id: 338997,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:05:01 GMT+0300 (Moscow Standard Time)',
      title:
        'Nintendo отсудила полмиллиона евро у размещавшего пиратские игры хостинга',
      description:
        'Компания Nintendo получит почти полмиллиона евро в качестве компенсации от файлового хостинга за распространение пиратских игр. Об этом сообщает портал DTF.\n\nАпелляционный суд Парижа признал компанию Dstorage виновной в нарушении авторских ...',
      image:
        'http://img.gazeta.ru/files3/637/13113637/20200331_gaf_u39_418-pic905-895x505-43367.jpg',
      source_id: 15,
      category_id: 1,
    },
    {
      id: 338969,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:01:27 GMT+0300 (Moscow Standard Time)',
      title:
        'Минцифры РФ: оснований для рассылки электронных повесток в России пока нет',
      description:
        'Способы оповещения граждан о необходимости явки в военкомат установит кабмин.',
      image:
        'https://aif-s3.aif.ru/images/032/017/b8269530defa7d1d37c9b89d90f87c04.jpg',
      source_id: 14,
      category_id: 5,
    },
    {
      id: 338975,
      lang: 'ru',
      date: 'Mon Apr 17 2023 19:00:01 GMT+0300 (Moscow Standard Time)',
      title: 'Россия впервые начала поставлять электроэнергию в Киргизию',
      description:
        'Компания "Интер РАО" (оператор экспорта и импорта электроэнергии в России) впервые в истории начала поставлять электроэнергию в Киргизию. Об этом заявили в компании, передает ТАСС.\n\n"15 апреля 2023 года, впервые в истории, ...',
      image:
        'https://img.gazeta.ru/files3/342/13469342/Depositphotos_376700536_xl-2015-pic905-895x505-60448.jpg',
      source_id: 15,
      category_id: 4,
    },
  ],
};

const mainNews = data.items.slice(1, 4);
const smallNews = data.items.slice(5, 14);
const categories = data.categories;
const sources = data.sources;

const mainNewsTemplate = document.getElementById('main-news-item');
const smallNewsTemplate = document.getElementById('small-news-item');

const mainNewsContainer = document.querySelector('.articles__big-column');
const smallNewsContainer = document.querySelector('.articles__small-column');

const createMainNewsItem = (item) => {
  const catName = categories.find((cat) => cat.id === item.category_id).name;
  const srcName = sources.find((src) => src.id === item.source_id).name;

  const article = document.createElement('article');
  const imageContainer = document.createElement('div');
  const image = document.createElement('img');
  const content = document.createElement('div');
  const category = document.createElement('span');
  const title = document.createElement('h2');
  const description = document.createElement('p');
  const source = document.createElement('span');

  imageContainer.appendChild(image);
  article.appendChild(imageContainer);
  content.appendChild(category);
  content.appendChild(title);
  content.appendChild(description);
  content.appendChild(source);
  article.appendChild(content);

  article.classList.add('main-article');
  imageContainer.classList.add('main-article__image-container');
  image.classList.add('main-article__image');
  content.classList.add('main-article__content');
  category.classList.add('article-category', 'main-article__category');
  title.classList.add('main-article__title');
  description.classList.add('main-article__text');
  source.classList.add('article-source', 'main-article__source');

  image.src = item.image;
  title.textContent = item.title;
  description.textContent = item.description;

  source.textContent = srcName;
  category.textContent = catName;

  return article;
};

mainNews.forEach((item) => {
  mainNewsContainer.appendChild(createMainNewsItem(item));
});

// ----- Экранирование символов -----
const escapeString = (string) => {
  const symbols = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt',
  };
  return string.replace(/[&<>]/g, (tag) => {
    return symbols[tag] || tag;
  });
};
// ----------------------------------

smallNews.forEach((item) => {
  const date = new Date(item.date).toLocaleDateString('ru-ru', {
    day: 'numeric',
    month: 'long',
  });

  const smallTemplate = document.createElement('template');

  smallTemplate.innerHTML = `
    <article class="small-article">
        <h2 class="small-article__title">
            ${escapeString(item.title)}
        </h2>
        <p class="small-article__caption">
            <span class="article-date small-article__date">${escapeString(
              date
            )}</span>
            <span class="article-source small-article__source">
                ${escapeString(
                  sources.find((src) => src.id === item.source_id).name
                )}
            </span>
        </p>
    </article>`;

  smallNewsContainer.appendChild(smallTemplate.content);
});
